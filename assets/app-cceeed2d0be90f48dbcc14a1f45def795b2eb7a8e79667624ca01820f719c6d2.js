function updateLocation(o,t,e){oldPosition=latlng,latlng=new google.maps.LatLng(o,t),marker.setPosition(latlng),map.panTo(latlng),map.setCenter(latlng),e%1!=0&&(e=e.toFixed(1)),document.getElementById("accuracy").innerHTML=e?e+"m":"n/a",document.getElementById("location").innerHTML=o+", "+t}function success(o){updateLocation(o.coords.latitude,o.coords.longitude,o.coords.accuracy)}function error(o){alert("string"==typeof o?o:"failed")}var status,map,marker,oldPosition,latlng,mapInit=function(){navigator.geolocation?(map=new google.maps.Map(document.getElementById("mapcanvas"),{zoom:18,mapTypeControl:!1,streetViewControl:!1,navigationControlOptions:{style:google.maps.NavigationControlStyle.LARGE},mapTypeId:google.maps.MapTypeId.ROADMAP}),marker=new google.maps.Marker({map:map,title:"Current position",draggable:!0,animation:google.maps.Animation.DROP}),google.maps.event.addListener(marker,"dragend",function(){var o=marker.getPosition();updateLocation(o.lat(),o.lng(),0)}),navigator.geolocation.getCurrentPosition(success,error)):error("not supported")};document.getElementById("find_me").onclick=function(){return navigator.geolocation.getCurrentPosition(success,error),!1},document.getElementById("add_marker").onclick=function(){return new google.maps.Marker({position:latlng,map:map,title:(new Date).toLocaleString(),icon:"http://labs.google.com/ridefinder/images/mm_20_gray.png"}),!1};